!function(e){function t(t){for(var o,i,c=t[0],a=t[1],l=t[2],h=0,f=[];h<c.length;h++)i=c[h],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&f.push(s[i][0]),s[i]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);for(d&&d(t);f.length;)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,c=1;c<n.length;c++){var a=n[c];0!==s[a]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},s={0:0},r=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=a;r.push([7,1]),n()}({4:function(e,t,n){},7:function(e,t,n){"use strict";n.r(t);n(4);var o=n(0);let r={distance:30,densityData:[],zoomState:null,zoomExtent:[1,8],screen:{},ext:{},colors:{gradientA:o.rgb(0,0,0),gradientB:o.rgb(60,60,60),contours:o.rgb(255,255,255,.5),tokens:o.rgb(255,255,255,.5),nodes:o.rgb(255,255,255,.5)},tokens:{}};var i=n.p+"nodes.json",c=n.p+"links.json";n(8);var a=()=>{(()=>{const e=o.extent(s.nodes,e=>Math.floor(e.x)),t=o.extent(s.nodes,e=>Math.floor(e.y)),n=e[1]-e[0],r=t[1]-t[0],i=e[0],c=t[0];s.densityData=o.contourDensity().x(e=>Math.floor(e.x)-i).y(e=>Math.floor(e.y)-c).weight(e=>e.relevancy).size([n,r]).cellSize(5).bandwidth(40).thresholds(15)(s.nodes),s.densityData.forEach(e=>e.coordinates=e.coordinates.map(e=>e.map(e=>e.map(e=>[e[0]+i,e[1]+c]))))})();const e=.8/s.densityData.length;let t=1;for(let n=s.densityData.length-1;n>=0;n--)s.context.beginPath(),s.context.strokeStyle=s.colors.contours,s.geoPath(s.densityData[n]),s.context.lineWidth=.8-e*t,t+=1,s.context.stroke()},l=()=>{const e=r.zoomState.x*r.screen.density,t=r.zoomState.y*r.screen.density,n=r.zoomState.k;r.screen.width=r.body.clientWidth*r.screen.density,r.screen.height=r.body.clientHeight*r.screen.density,r.context.scale(r.screen.density,r.screen.density),r.canvas.style("width",`${r.body.clientWidth}px`).style("height",`${r.body.clientHeight}px`).attr("width",r.screen.width).attr("height",r.screen.height),r.context.save(),r.context.clearRect(0,0,r.screen.width,r.screen.height),r.context.translate(e,t),r.context.scale(n,n),a(),r.links.forEach(e=>{const t=Math.floor(Math.abs(e.source.x-e.target.x)),n=Math.floor(Math.abs(e.source.y-e.target.y)),o=Math.pow(t,2)+Math.pow(n,2);if(r.ext.distance.min<o&&o<r.ext.distance.max){const o=Math.floor(t/2+(e.source.x<e.target.x?e.source.x:e.target.x)),s=Math.floor(n/2+(e.source.y<e.target.y?e.source.y:e.target.y)),i=Object.entries(e.tokens)[0];"function"==typeof r.tokens[i[0]]&&r.tokens[i[0]](o,s,i[1])}}),s.nodes.forEach(e=>{s.node&&(s.node.peers.includes(e.id)||e.id==s.node.id)?s.drawRedNode(Math.floor(e.x),Math.floor(e.y)):s.drawWhiteNode(Math.floor(e.x),Math.floor(e.y))}),r.context.restore()},d=()=>{d3.select("#background").style("width",`${s.body.clientWidth}px`).style("height",`${s.body.clientHeight}px`).attr("width",s.screen.width).attr("height",s.screen.height);const e=document.querySelector("#background").getContext("2d",{alpha:!1}),t=e.createRadialGradient(s.screen.width/2,s.screen.height/2,0,s.screen.width/2,s.screen.height/2,s.screen.width/2);t.addColorStop(1,s.colors.gradientA),t.addColorStop(0,s.colors.gradientB),e.fillStyle=t,e.fillRect(0,0,s.screen.width,s.screen.height)};window.s=r,r.zoomState=o.zoomIdentity;var h=()=>{o.select("#searchField").on("input",(function(){const e=r.nodes.find(e=>(console.log(this),-1!==e.id.toLowerCase().indexOf(this.value.toLowerCase())));o.select("#searchResults").html(""),o.select("#searchResults").append("p").html(`Press the key 'enter'<br>to focus on ${e.id}`),console.log("matching",e),r.zoomTo=e})).on("keypress",(function(){if(32===o.event.keyCode||13===o.event.keyCode){const e=8,t=(r.screen.width/2-r.zoomTo.x*e)/r.screen.density,n=(r.screen.height/2-r.zoomTo.y*e)/r.screen.density;r.zoomState=o.zoomIdentity.translate(t,n).scale(e),r.canvas.transition().duration(2e3).call(r.zoom.transform,r.zoomState)}}))},f=n(3),y=n.n(f);window.d3=o,window.s=r,Promise.all([o.json(i),o.json(c)]).then(([e,t])=>{r.links=t,r.nodes=e,console.log("nodes",r.nodes.length),console.log("links",r.links.length),s.linkExtent=[],s.linkExtent[0]=s.links.reduce((e,t)=>{const n=Object.entries(t.tokens);for(const[t,o]of n)return e<o?e:o},1/0),s.linkExtent[1]=s.links.reduce((e,t)=>{const n=Object.entries(t.tokens);for(const[t,o]of n)return e>o?e:o},0),s.ext.years={min:s.nodes.reduce((e,t)=>(Object.keys(t.years).forEach(t=>{t<e&&(e=t)}),e),1/0),max:s.nodes.reduce((e,t)=>(Object.keys(t.years).forEach(t=>{t>e&&(e=t)}),e),0)},"devicePixelRatio"in window&&window.devicePixelRatio>1?s.screen.density=window.devicePixelRatio:s.screen.density=1,console.log("screen density:",s.screen.density),s.body=document.querySelector("body"),s.screen.width=s.body.clientWidth*s.screen.density,s.screen.height=s.body.clientHeight*s.screen.density,s.canvas=o.select("#visualization"),s.context=document.querySelector("#visualization").getContext("2d"),(()=>{const e=document.createElement("canvas");e.width=20,e.height=20;const t=e.getContext("2d");t.fillStyle=s.colors.nodes,t.font="40px Arial",t.textBaseline="middle",t.textAlign="center",t.fillText("●",10,10),s.drawWhiteNode=(t,n)=>{s.context.drawImage(e,t-1,n-1,2,2)};const n=document.createElement("canvas");n.width=20,n.height=20;const o=n.getContext("2d");o.fillStyle="red",o.font="40px Arial",o.textBaseline="middle",o.textAlign="center",o.fillText("●",10,10),s.drawRedNode=(e,t)=>{s.context.drawImage(n,e-1,t-1,2,2)}})(),(()=>{s.ext.distance={min:Math.pow(s.distance*s.screen.density/2,2),max:Math.pow(s.distance*s.screen.density,2)};const e=s.nodes.reduce((e,t)=>{let n=0;for(let o in t.tokens)if(e.includes("token")||e.push(o),3==++n)break;return e},[]);console.log(e),e.forEach(e=>{const t=document.createElement("canvas");t.width=250,t.height=40;const n=t.getContext("2d");n.fillStyle=s.colors.tokens,n.font="40px Arial",n.textBaseline="middle",n.textAlign="center";const o=Math.floor(125),r=Math.floor(20);n.fillText(e,o,r),s.tokens[e]=(e,n,o)=>{const r=Math.floor(250*o/2e3),i=Math.floor(40*o/2e3);e-=Math.floor(r/2),n-=Math.floor(i/2),s.context.drawImage(t,e,n,r,i)}})})(),s.geoPath=d3.geoPath().context(s.context),(()=>{const e=y()({every:1});setInterval(()=>{e.tick()},1e3/60);const t=document.getElementById("fps");e.on("data",(function(e){t.innerHTML=Math.floor(parseInt(e))}))})(),d(),(()=>{const e=o.forceSimulation().force("collide",o.forceCollide().radius(r.distance).strength(.5).iterations(4)).force("center",o.forceCenter(r.screen.width/2,r.screen.height/2)).force("link",o.forceLink().id(e=>e.id).strength(e=>.8*e.value));e.nodes(r.nodes),e.force("link").links(r.links);e.on("tick",l).on("end",()=>{r.end=!0,l()}),window.onresize=function(){d(),l()},r.zoom=o.zoom().on("zoom",()=>{r.zoomState=o.event.transform,l()}),r.zoom.scaleExtent(r.zoomExtent),r.zoom.scaleTo(r.canvas,r.zoomExtent[0]),r.canvas.call(r.zoom)})(),s.canvas.on("mousemove",()=>{const e=s.zoomState.invertX(event.x)*s.screen.density,t=s.zoomState.invertY(event.y)*s.screen.density,n=o.select("#focus .left"),r=o.select("#focus .middle"),i=o.select("#focus .right");let c=!1;s.nodes.forEach(o=>{const a=e-o.x,l=t-o.y,d='<span class="block"></span>';if(a*a+l*l<400){s.node=o,c=!0;const e='<tr style="height:10px"><td></td><td></td></tr>',t='<tr><th colspan="2"><hr></th></tr>';let a="<table>";a+='<tr><td style="width:80px"></td><td style="width:80px"></td></tr>',a+=`<tr><td colspan="2" style="text-align:center;"><h1>${o.name}</h1></td></tr>`,a+=`<tr><td colspan="2" style="text-align:center;">${o.docs} publications</td></tr>`,a+=e,a+='<tr><td colspan="2" style="text-align:center;">Tokens by tf-idf</td></tr>',a+=t,a+=Object.entries(o.tokens).reduce((e,t,n)=>{const o=t[1]/10,s=d.repeat(o);return e+=`<tr><td style="text-align: right;">${t[0]}</td><td>${s}</td></tr>`},[]),a+="</table>",i.html(a),a="<table>",a+='<tr><td style="text-align:center;">List of co-authors</td></tr>',a+=t,o.peers.forEach(e=>{const t=s.nodes.find(t=>t.id==e);void 0!==t&&(a+=`<tr><td>${t.name}</td></tr>`)}),a+="</table>",r.html(a),a="<table>",a+='<tr><td style="width:20px"></td><td style="width:50px"></td></tr>',a+='<tr><td colspan="2" style="text-align:center;">Publications by year</td></tr>',a+=t;for(let e=s.ext.years.min;e<=s.ext.years.max;e++){const t=void 0===o.years[e]?0:2*o.years[e],n=d.repeat(t);a+=`<tr><td style="text-align: right;">${e}</td><td>${n}</td></tr>`}a+="</table>",n.html(a)}}),d(),l(),c||(n.html(""),r.html(""),i.html(""),s.node=null)}),h()})}});